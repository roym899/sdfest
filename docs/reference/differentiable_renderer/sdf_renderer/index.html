
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://roym899.github.io/sdfest/reference/differentiable_renderer/sdf_renderer/">
      
      
        <link rel="prev" href="../scripts/experiments/">
      
      
        <link rel="next" href="../../estimation/losses/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.9">
    
    
      
        <title>sdf_renderer - SDFEst</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.f2e4d321.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sdfest.differentiable_renderer.sdf_renderer" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="SDFEst" class="md-header__button md-logo" aria-label="SDFEst" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SDFEst
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              sdf_renderer
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/roym899/sdfest" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    roym899/sdfest
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="SDFEst" class="md-nav__button md-logo" aria-label="SDFEst" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    SDFEst
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/roym899/sdfest" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    roym899/sdfest
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    differentiable_renderer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            differentiable_renderer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    scripts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scripts/experiments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    experiments
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    sdf_renderer
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    sdf_renderer
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer" class="md-nav__link">
    <span class="md-ellipsis">
      sdf_renderer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.Camera" class="md-nav__link">
    <span class="md-ellipsis">
      Camera
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Camera">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.Camera.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.Camera.get_o3d_pinhole_camera_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_o3d_pinhole_camera_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.Camera.get_pinhole_camera_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_pinhole_camera_parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunction" class="md-nav__link">
    <span class="md-ellipsis">
      SDFRendererFunction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SDFRendererFunction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunction.backward" class="md-nav__link">
    <span class="md-ellipsis">
      backward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunction.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunctionGPU" class="md-nav__link">
    <span class="md-ellipsis">
      SDFRendererFunctionGPU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SDFRendererFunctionGPU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunctionGPU.backward" class="md-nav__link">
    <span class="md-ellipsis">
      backward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunctionGPU.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.render_depth_gpu" class="md-nav__link">
    <span class="md-ellipsis">
      render_depth_gpu
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    estimation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            estimation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimation/losses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    losses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimation/metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    scripts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimation/scripts/play_log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    play_log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimation/scripts/real_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    real_data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimation/scripts/rendering_evaluation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rendering_evaluation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimation/simple_setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    simple_setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimation/synthetic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    synthetic
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    initialization
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            initialization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_3_1" id="__nav_2_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    datasets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_1">
            <span class="md-nav__icon md-icon"></span>
            datasets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/datasets/dataset_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dataset_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/datasets/generated_dataset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    generated_dataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/datasets/nocs_dataset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nocs_dataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/datasets/nocs_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nocs_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/datasets/redwood_dataset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redwood_dataset
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/pointnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pointnet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/pointset_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pointset_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/quaternion_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quaternion_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_5" >
        
          
          <label class="md-nav__link" for="__nav_2_3_5" id="__nav_2_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    scripts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_5">
            <span class="md-nav__icon md-icon"></span>
            scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/scripts/train/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    train
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/sdf_pose_network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sdf_pose_network
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/sdf_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sdf_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/so3grid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    so3grid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../initialization/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    vae
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            vae
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_1" >
        
          
          <label class="md-nav__link" for="__nav_2_5_1" id="__nav_2_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    scripts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_1">
            <span class="md-nav__icon md-icon"></span>
            scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vae/scripts/benchmark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    benchmark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vae/scripts/benchmark_vae/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    benchmark_vae
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vae/scripts/process_shapenet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    process_shapenet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vae/scripts/train/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    train
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vae/scripts/visualizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    visualizer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vae/sdf_dataset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sdf_dataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vae/sdf_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sdf_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vae/sdf_vae/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sdf_vae
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vae/torch_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torch_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vae/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer" class="md-nav__link">
    <span class="md-ellipsis">
      sdf_renderer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.Camera" class="md-nav__link">
    <span class="md-ellipsis">
      Camera
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Camera">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.Camera.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.Camera.get_o3d_pinhole_camera_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_o3d_pinhole_camera_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.Camera.get_pinhole_camera_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_pinhole_camera_parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunction" class="md-nav__link">
    <span class="md-ellipsis">
      SDFRendererFunction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SDFRendererFunction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunction.backward" class="md-nav__link">
    <span class="md-ellipsis">
      backward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunction.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunctionGPU" class="md-nav__link">
    <span class="md-ellipsis">
      SDFRendererFunctionGPU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SDFRendererFunctionGPU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunctionGPU.backward" class="md-nav__link">
    <span class="md-ellipsis">
      backward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunctionGPU.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sdfest.differentiable_renderer.sdf_renderer.render_depth_gpu" class="md-nav__link">
    <span class="md-ellipsis">
      render_depth_gpu
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>sdf_renderer</h1>

<div class="doc doc-object doc-module">



<a id="sdfest.differentiable_renderer.sdf_renderer"></a>
  <div class="doc doc-contents first">
  
      <p>PyTorch interface for diffferentiable renderer.</p>

<details class="this-module-provides-two-functions" open>
  <summary>This module provides two functions</summary>
  <ul>
<li>render_depth: numpy-based CPU implementation
(not recommended, only for development)</li>
<li>render_depth_gpu: CUDA implementation (fast)</li>
</ul>
</details>
  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="sdfest.differentiable_renderer.sdf_renderer.Camera" class="doc doc-heading">
          <code>Camera</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Pinhole camera parameters.</p>
<p>This class allows conversion between different pixel conventions, i.e., pixel
center at (0.5, 0.5) (as common in computer graphics), and (0, 0) as common in
computer vision.</p>

            <details class="quote">
              <summary>Source code in <code>sdfest/differentiable_renderer/sdf_renderer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Camera</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pinhole camera parameters.</span>

<span class="sd">    This class allows conversion between different pixel conventions, i.e., pixel</span>
<span class="sd">    center at (0.5, 0.5) (as common in computer graphics), and (0, 0) as common in</span>
<span class="sd">    computer vision.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">fx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">fy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">cx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">cy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">pixel_center</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize camera parameters.</span>

<span class="sd">        Note that the principal point is only fully defined in combination with</span>
<span class="sd">        pixel_center.</span>

<span class="sd">        The pixel_center defines the relation between continuous image plane</span>
<span class="sd">        coordinates and discrete pixel coordinates.</span>

<span class="sd">        A discrete image coordinate (x, y) will correspond to the continuous</span>
<span class="sd">        image coordinate (x + pixel_center, y + pixel_center). Normally pixel_center</span>
<span class="sd">        will be either 0 or 0.5. During calibration it depends on the convention</span>
<span class="sd">        the point features used to compute the calibration matrix.</span>

<span class="sd">        Note that if pixel_center == 0, the corresponding continuous coordinate</span>
<span class="sd">        interval for a pixel are [x-0.5, x+0.5). I.e., proper rounding has to be done</span>
<span class="sd">        to convert from continuous coordinate to the corresponding discrete coordinate.</span>

<span class="sd">        For pixel_center == 0.5, the corresponding continuous coordinate interval for a</span>
<span class="sd">        pixel are [x, x+1). I.e., floor is sufficient to convert from continuous</span>
<span class="sd">        coordinate to the corresponding discrete coordinate.</span>

<span class="sd">        Args:</span>
<span class="sd">            width: Number of pixels in horizontal direction.</span>
<span class="sd">            height: Number of pixels in vertical direction.</span>
<span class="sd">            fx: Horizontal focal length.</span>
<span class="sd">            fy: Vertical focal length.</span>
<span class="sd">            cx: Principal point x-coordinate.</span>
<span class="sd">            cy: Principal point y-coordinate.</span>
<span class="sd">            s: Skew.</span>
<span class="sd">            pixel_center: The center offset for the provided principal point.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># focal length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fx</span> <span class="o">=</span> <span class="n">fx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fy</span> <span class="o">=</span> <span class="n">fy</span>

        <span class="c1"># principal point</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">=</span> <span class="n">cx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">=</span> <span class="n">cy</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_center</span> <span class="o">=</span> <span class="n">pixel_center</span>

        <span class="c1"># skew</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">s</span>

        <span class="c1"># image dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>

    <span class="k">def</span> <span class="nf">get_o3d_pinhole_camera_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">o3d</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">PinholeCameraParameters</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert camera to Open3D pinhole camera parameters.</span>

<span class="sd">        Open3D camera is at (0,0,0) looking along positive z axis (i.e., positive z</span>
<span class="sd">        values are in front of camera). Open3D expects camera with pixel_center = 0</span>
<span class="sd">        and does not support skew.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The pinhole camera parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pinhole_camera_parameters</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">o3d</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">PinholeCameraParameters</span><span class="p">()</span>
        <span class="n">params</span><span class="o">.</span><span class="n">intrinsic</span><span class="o">.</span><span class="n">set_intrinsics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">)</span>
        <span class="n">params</span><span class="o">.</span><span class="n">extrinsic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">params</span>

    <span class="k">def</span> <span class="nf">get_pinhole_camera_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pixel_center</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert camera to general camera parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            pixel_center:</span>
<span class="sd">                At which ratio of a square the pixel center should be for the resulting</span>
<span class="sd">                parameters. Typically 0 or 0.5. See class documentation for more info.</span>
<span class="sd">        Returns:</span>
<span class="sd">            - fx, fy: The horizontal and vertical focal length</span>
<span class="sd">            - cx, cy:</span>
<span class="sd">                The position of the principal point in continuous image plane</span>
<span class="sd">                coordinates considering the provided pixel center and the pixel center</span>
<span class="sd">                specified during the construction.</span>
<span class="sd">            - s: The skew.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cx_corrected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_center</span> <span class="o">+</span> <span class="n">pixel_center</span>
        <span class="n">cy_corrected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_center</span> <span class="o">+</span> <span class="n">pixel_center</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fy</span><span class="p">,</span> <span class="n">cx_corrected</span><span class="p">,</span> <span class="n">cy_corrected</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="sdfest.differentiable_renderer.sdf_renderer.Camera.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">pixel_center</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize camera parameters.</p>
<p>Note that the principal point is only fully defined in combination with
pixel_center.</p>
<p>The pixel_center defines the relation between continuous image plane
coordinates and discrete pixel coordinates.</p>
<p>A discrete image coordinate (x, y) will correspond to the continuous
image coordinate (x + pixel_center, y + pixel_center). Normally pixel_center
will be either 0 or 0.5. During calibration it depends on the convention
the point features used to compute the calibration matrix.</p>
<p>Note that if pixel_center == 0, the corresponding continuous coordinate
interval for a pixel are [x-0.5, x+0.5). I.e., proper rounding has to be done
to convert from continuous coordinate to the corresponding discrete coordinate.</p>
<p>For pixel_center == 0.5, the corresponding continuous coordinate interval for a
pixel are [x, x+1). I.e., floor is sufficient to convert from continuous
coordinate to the corresponding discrete coordinate.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>width</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of pixels in horizontal direction.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>height</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of pixels in vertical direction.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fx</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal focal length.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fy</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vertical focal length.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cx</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Principal point x-coordinate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cy</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Principal point y-coordinate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>s</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Skew.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>pixel_center</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The center offset for the provided principal point.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>sdfest/differentiable_renderer/sdf_renderer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">fx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">fy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">cx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">cy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">pixel_center</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize camera parameters.</span>

<span class="sd">    Note that the principal point is only fully defined in combination with</span>
<span class="sd">    pixel_center.</span>

<span class="sd">    The pixel_center defines the relation between continuous image plane</span>
<span class="sd">    coordinates and discrete pixel coordinates.</span>

<span class="sd">    A discrete image coordinate (x, y) will correspond to the continuous</span>
<span class="sd">    image coordinate (x + pixel_center, y + pixel_center). Normally pixel_center</span>
<span class="sd">    will be either 0 or 0.5. During calibration it depends on the convention</span>
<span class="sd">    the point features used to compute the calibration matrix.</span>

<span class="sd">    Note that if pixel_center == 0, the corresponding continuous coordinate</span>
<span class="sd">    interval for a pixel are [x-0.5, x+0.5). I.e., proper rounding has to be done</span>
<span class="sd">    to convert from continuous coordinate to the corresponding discrete coordinate.</span>

<span class="sd">    For pixel_center == 0.5, the corresponding continuous coordinate interval for a</span>
<span class="sd">    pixel are [x, x+1). I.e., floor is sufficient to convert from continuous</span>
<span class="sd">    coordinate to the corresponding discrete coordinate.</span>

<span class="sd">    Args:</span>
<span class="sd">        width: Number of pixels in horizontal direction.</span>
<span class="sd">        height: Number of pixels in vertical direction.</span>
<span class="sd">        fx: Horizontal focal length.</span>
<span class="sd">        fy: Vertical focal length.</span>
<span class="sd">        cx: Principal point x-coordinate.</span>
<span class="sd">        cy: Principal point y-coordinate.</span>
<span class="sd">        s: Skew.</span>
<span class="sd">        pixel_center: The center offset for the provided principal point.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># focal length</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fx</span> <span class="o">=</span> <span class="n">fx</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fy</span> <span class="o">=</span> <span class="n">fy</span>

    <span class="c1"># principal point</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">=</span> <span class="n">cx</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">=</span> <span class="n">cy</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pixel_center</span> <span class="o">=</span> <span class="n">pixel_center</span>

    <span class="c1"># skew</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">s</span>

    <span class="c1"># image dimensions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="sdfest.differentiable_renderer.sdf_renderer.Camera.get_o3d_pinhole_camera_parameters" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_o3d_pinhole_camera_parameters</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert camera to Open3D pinhole camera parameters.</p>
<p>Open3D camera is at (0,0,0) looking along positive z axis (i.e., positive z
values are in front of camera). Open3D expects camera with pixel_center = 0
and does not support skew.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="open3d.camera.PinholeCameraParameters">PinholeCameraParameters</span>()</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pinhole camera parameters.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>sdfest/differentiable_renderer/sdf_renderer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_o3d_pinhole_camera_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">o3d</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">PinholeCameraParameters</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert camera to Open3D pinhole camera parameters.</span>

<span class="sd">    Open3D camera is at (0,0,0) looking along positive z axis (i.e., positive z</span>
<span class="sd">    values are in front of camera). Open3D expects camera with pixel_center = 0</span>
<span class="sd">    and does not support skew.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The pinhole camera parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pinhole_camera_parameters</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">o3d</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">PinholeCameraParameters</span><span class="p">()</span>
    <span class="n">params</span><span class="o">.</span><span class="n">intrinsic</span><span class="o">.</span><span class="n">set_intrinsics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">)</span>
    <span class="n">params</span><span class="o">.</span><span class="n">extrinsic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">params</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="sdfest.differentiable_renderer.sdf_renderer.Camera.get_pinhole_camera_parameters" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_pinhole_camera_parameters</span><span class="p">(</span><span class="n">pixel_center</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert camera to general camera parameters.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pixel_center</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>At which ratio of a square the pixel center should be for the resulting
parameters. Typically 0 or 0.5. See class documentation for more info.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    - fx, fy: The horizontal and vertical focal length
    - cx, cy:
        The position of the principal point in continuous image plane
        coordinates considering the provided pixel center and the pixel center
        specified during the construction.
    - s: The skew.</p>

          <details class="quote">
            <summary>Source code in <code>sdfest/differentiable_renderer/sdf_renderer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_pinhole_camera_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pixel_center</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert camera to general camera parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        pixel_center:</span>
<span class="sd">            At which ratio of a square the pixel center should be for the resulting</span>
<span class="sd">            parameters. Typically 0 or 0.5. See class documentation for more info.</span>
<span class="sd">    Returns:</span>
<span class="sd">        - fx, fy: The horizontal and vertical focal length</span>
<span class="sd">        - cx, cy:</span>
<span class="sd">            The position of the principal point in continuous image plane</span>
<span class="sd">            coordinates considering the provided pixel center and the pixel center</span>
<span class="sd">            specified during the construction.</span>
<span class="sd">        - s: The skew.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cx_corrected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_center</span> <span class="o">+</span> <span class="n">pixel_center</span>
    <span class="n">cy_corrected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_center</span> <span class="o">+</span> <span class="n">pixel_center</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fy</span><span class="p">,</span> <span class="n">cx_corrected</span><span class="p">,</span> <span class="n">cy_corrected</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunction" class="doc doc-heading">
          <code>SDFRendererFunction</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.autograd.Function">Function</span></code></p>

  
      <p>Renderer function for signed distance fields.</p>

            <details class="quote">
              <summary>Source code in <code>sdfest/differentiable_renderer/sdf_renderer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SDFRendererFunction</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Renderer function for signed distance fields.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="n">ctx</span><span class="p">,</span>
        <span class="n">sdf</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">orientation</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">inv_scale</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">height</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fov_deg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">camera</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Camera</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Render depth image of a 7-DOF discrete signed distance field.</span>

<span class="sd">        The SDF position is assumed to be in the camera frame under OpenGL convention.</span>

<span class="sd">        That is, camera looks along negative z-axis, y pointing upwards and x to the</span>
<span class="sd">        right. Note that the rendered image will still follow the classical computer</span>
<span class="sd">        vision convention, of first row being up in the camera frame.</span>

<span class="sd">        This function internally usese numpy and is very slow due to the fully serial</span>
<span class="sd">        implementation. This is only for testing purposes. Use the GPU version for</span>
<span class="sd">        practical performance.</span>

<span class="sd">        Camera can be specified either via camera parameter giving most</span>
<span class="sd">        flexbility or alternatively by providing width, height and fov_deg.</span>

<span class="sd">        Args:</span>
<span class="sd">            ctx:</span>
<span class="sd">                Context object to stash information.</span>
<span class="sd">                See https://pytorch.org/docs/stable/notes/extending.html.</span>
<span class="sd">            sdf:</span>
<span class="sd">                Discrete signed distance field with shape (M, M, M).</span>
<span class="sd">                Arbitrary (but uniform) resolutions are supported.</span>
<span class="sd">            position:</span>
<span class="sd">                The position of the signed distance field origin in the camera frame.</span>
<span class="sd">            orientation:</span>
<span class="sd">                The orientation of the SDF as a normalized quaternion.</span>
<span class="sd">            inv_scale:</span>
<span class="sd">                The inverted scale of the SDF. The scale of an SDF the half-width of the</span>
<span class="sd">                full SDF volume.</span>
<span class="sd">            width:</span>
<span class="sd">                Number of pixels in x direction. Recommended to use camera instead.</span>
<span class="sd">            height:</span>
<span class="sd">                Number of pixels in y direction. Recommended to use camera instead.</span>
<span class="sd">            fov_deg:</span>
<span class="sd">                The horizontal field of view (i.e., in x direction).</span>
<span class="sd">                Pixels are assumed to be square, i.e., fx=fy, computed based on width</span>
<span class="sd">                and fov_deg.</span>
<span class="sd">                Recommended to use camera instead.</span>
<span class="sd">            threshold:</span>
<span class="sd">                The distance threshold at which sphere tracing should be stopped.</span>
<span class="sd">                Smaller value will be more accurate, but slower and might potentially</span>
<span class="sd">                lead to holes in the rendering for thin structures in the SDF.</span>
<span class="sd">                Larger values will be faster, but will overestimate the thickness.</span>

<span class="sd">                Should always be positive to guarantee convergence.</span>
<span class="sd">            camera:</span>
<span class="sd">                Camera parameters (not supported right now).</span>
<span class="sd">        Returns:</span>
<span class="sd">            The rendered depth image.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="kc">None</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">fov_deg</span><span class="p">]</span> <span class="ow">and</span> <span class="n">camera</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either width+height+fov_dev or camera must be provided.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">camera</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;Only width+height+fov_dev currently supported for CPU&quot;</span>
            <span class="p">)</span>
        <span class="c1"># for simplicity use numpy internally</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">save_for_backward</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">inv_scale</span><span class="p">)</span>
        <span class="n">sdf</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="n">position</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="n">orientation</span> <span class="o">=</span> <span class="n">orientation</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="n">inv_scale</span> <span class="o">=</span> <span class="n">inv_scale</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="n">sdf_object</span> <span class="o">=</span> <span class="n">SDFObject</span><span class="p">(</span><span class="n">sdf</span><span class="p">)</span>
        <span class="n">image</span><span class="p">,</span> <span class="n">derivatives</span> <span class="o">=</span> <span class="n">_render_depth</span><span class="p">(</span>
            <span class="n">sdf_object</span><span class="p">,</span>
            <span class="n">width</span><span class="p">,</span>
            <span class="n">height</span><span class="p">,</span>
            <span class="n">fov_deg</span><span class="p">,</span>
            <span class="s2">&quot;d&quot;</span><span class="p">,</span>
            <span class="n">threshold</span><span class="p">,</span>
            <span class="n">position</span><span class="p">,</span>
            <span class="n">orientation</span><span class="p">,</span>
            <span class="n">inv_scale</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">derivatives</span> <span class="o">=</span> <span class="n">derivatives</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">inp</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute gradients of inputs with respect to the provided gradients.</span>

<span class="sd">        Normally called by PyTorch as part of a call to backward() on a loss.</span>

<span class="sd">        Args:</span>
<span class="sd">            grad_depth_image:</span>
<span class="sd">        Returns:</span>
<span class="sd">            Gradients of</span>
<span class="sd">                discretized signed distance field, position, orientation, inverted scale</span>
<span class="sd">                followed by None for all the non-supported variables passed to forward.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">derivatives</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">derivatives</span>
        <span class="n">sdf</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">quat</span><span class="p">,</span> <span class="n">inv_s</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">saved_tensors</span>
        <span class="n">g_image</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="n">g_sdf</span> <span class="o">=</span> <span class="n">g_p</span> <span class="o">=</span> <span class="n">g_q</span> <span class="o">=</span> <span class="n">g_is</span> <span class="o">=</span> <span class="n">g_w</span> <span class="o">=</span> <span class="n">g_h</span> <span class="o">=</span> <span class="n">g_fov</span> <span class="o">=</span> <span class="n">g_thresh</span> <span class="o">=</span> <span class="n">g_camera</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">g_sdf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sdf</span><span class="p">)</span>
        <span class="n">g_p</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">g_q</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">quat</span><span class="p">)</span>
        <span class="n">g_is</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">inv_s</span><span class="p">)</span>
        <span class="n">g_p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
        <span class="n">g_p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
        <span class="n">g_p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
        <span class="n">g_q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;qx&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
        <span class="n">g_q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;qy&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
        <span class="n">g_q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;qz&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
        <span class="n">g_q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;qw&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
        <span class="n">g_is</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;s_inv&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
        <span class="k">if</span> <span class="s2">&quot;sdf&quot;</span> <span class="ow">in</span> <span class="n">derivatives</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;sdf&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">g_sdf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">v</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">g_sdf</span><span class="p">,</span> <span class="n">g_p</span><span class="p">,</span> <span class="n">g_q</span><span class="p">,</span> <span class="n">g_is</span><span class="p">,</span> <span class="n">g_w</span><span class="p">,</span> <span class="n">g_h</span><span class="p">,</span> <span class="n">g_fov</span><span class="p">,</span> <span class="n">g_thresh</span><span class="p">,</span> <span class="n">g_camera</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunction.backward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">backward</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">inp</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Compute gradients of inputs with respect to the provided gradients.</p>
<p>Normally called by PyTorch as part of a call to backward() on a loss.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>grad_depth_image</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    Gradients of
        discretized signed distance field, position, orientation, inverted scale
        followed by None for all the non-supported variables passed to forward.</p>

          <details class="quote">
            <summary>Source code in <code>sdfest/differentiable_renderer/sdf_renderer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">inp</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute gradients of inputs with respect to the provided gradients.</span>

<span class="sd">    Normally called by PyTorch as part of a call to backward() on a loss.</span>

<span class="sd">    Args:</span>
<span class="sd">        grad_depth_image:</span>
<span class="sd">    Returns:</span>
<span class="sd">        Gradients of</span>
<span class="sd">            discretized signed distance field, position, orientation, inverted scale</span>
<span class="sd">            followed by None for all the non-supported variables passed to forward.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">derivatives</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">derivatives</span>
    <span class="n">sdf</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">quat</span><span class="p">,</span> <span class="n">inv_s</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">saved_tensors</span>
    <span class="n">g_image</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="n">g_sdf</span> <span class="o">=</span> <span class="n">g_p</span> <span class="o">=</span> <span class="n">g_q</span> <span class="o">=</span> <span class="n">g_is</span> <span class="o">=</span> <span class="n">g_w</span> <span class="o">=</span> <span class="n">g_h</span> <span class="o">=</span> <span class="n">g_fov</span> <span class="o">=</span> <span class="n">g_thresh</span> <span class="o">=</span> <span class="n">g_camera</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">g_sdf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sdf</span><span class="p">)</span>
    <span class="n">g_p</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
    <span class="n">g_q</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">quat</span><span class="p">)</span>
    <span class="n">g_is</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">inv_s</span><span class="p">)</span>
    <span class="n">g_p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
    <span class="n">g_p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
    <span class="n">g_p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
    <span class="n">g_q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;qx&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
    <span class="n">g_q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;qy&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
    <span class="n">g_q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;qz&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
    <span class="n">g_q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;qw&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
    <span class="n">g_is</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;s_inv&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
    <span class="k">if</span> <span class="s2">&quot;sdf&quot;</span> <span class="ow">in</span> <span class="n">derivatives</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">derivatives</span><span class="p">[</span><span class="s2">&quot;sdf&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">g_sdf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">v</span> <span class="o">*</span> <span class="n">g_image</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">g_sdf</span><span class="p">,</span> <span class="n">g_p</span><span class="p">,</span> <span class="n">g_q</span><span class="p">,</span> <span class="n">g_is</span><span class="p">,</span> <span class="n">g_w</span><span class="p">,</span> <span class="n">g_h</span><span class="p">,</span> <span class="n">g_fov</span><span class="p">,</span> <span class="n">g_thresh</span><span class="p">,</span> <span class="n">g_camera</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunction.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">sdf</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">inv_scale</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fov_deg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">camera</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Render depth image of a 7-DOF discrete signed distance field.</p>
<p>The SDF position is assumed to be in the camera frame under OpenGL convention.</p>
<p>That is, camera looks along negative z-axis, y pointing upwards and x to the
right. Note that the rendered image will still follow the classical computer
vision convention, of first row being up in the camera frame.</p>
<p>This function internally usese numpy and is very slow due to the fully serial
implementation. This is only for testing purposes. Use the GPU version for
practical performance.</p>
<p>Camera can be specified either via camera parameter giving most
flexbility or alternatively by providing width, height and fov_deg.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ctx</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Context object to stash information.
See https://pytorch.org/docs/stable/notes/extending.html.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sdf</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Discrete signed distance field with shape (M, M, M).
Arbitrary (but uniform) resolutions are supported.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>position</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The position of the signed distance field origin in the camera frame.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>orientation</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The orientation of the SDF as a normalized quaternion.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inv_scale</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The inverted scale of the SDF. The scale of an SDF the half-width of the
full SDF volume.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>width</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of pixels in x direction. Recommended to use camera instead.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>height</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of pixels in y direction. Recommended to use camera instead.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>fov_deg</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The horizontal field of view (i.e., in x direction).
Pixels are assumed to be square, i.e., fx=fy, computed based on width
and fov_deg.
Recommended to use camera instead.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The distance threshold at which sphere tracing should be stopped.
Smaller value will be more accurate, but slower and might potentially
lead to holes in the rendering for thin structures in the SDF.
Larger values will be faster, but will overestimate the thickness.</p>
<p>Should always be positive to guarantee convergence.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>camera</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="sdfest.differentiable_renderer.sdf_renderer.Camera" href="#sdfest.differentiable_renderer.sdf_renderer.Camera">Camera</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Camera parameters (not supported right now).</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    The rendered depth image.</p>

          <details class="quote">
            <summary>Source code in <code>sdfest/differentiable_renderer/sdf_renderer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">,</span>
    <span class="n">sdf</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">orientation</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">inv_scale</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">height</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fov_deg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">camera</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Camera</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Render depth image of a 7-DOF discrete signed distance field.</span>

<span class="sd">    The SDF position is assumed to be in the camera frame under OpenGL convention.</span>

<span class="sd">    That is, camera looks along negative z-axis, y pointing upwards and x to the</span>
<span class="sd">    right. Note that the rendered image will still follow the classical computer</span>
<span class="sd">    vision convention, of first row being up in the camera frame.</span>

<span class="sd">    This function internally usese numpy and is very slow due to the fully serial</span>
<span class="sd">    implementation. This is only for testing purposes. Use the GPU version for</span>
<span class="sd">    practical performance.</span>

<span class="sd">    Camera can be specified either via camera parameter giving most</span>
<span class="sd">    flexbility or alternatively by providing width, height and fov_deg.</span>

<span class="sd">    Args:</span>
<span class="sd">        ctx:</span>
<span class="sd">            Context object to stash information.</span>
<span class="sd">            See https://pytorch.org/docs/stable/notes/extending.html.</span>
<span class="sd">        sdf:</span>
<span class="sd">            Discrete signed distance field with shape (M, M, M).</span>
<span class="sd">            Arbitrary (but uniform) resolutions are supported.</span>
<span class="sd">        position:</span>
<span class="sd">            The position of the signed distance field origin in the camera frame.</span>
<span class="sd">        orientation:</span>
<span class="sd">            The orientation of the SDF as a normalized quaternion.</span>
<span class="sd">        inv_scale:</span>
<span class="sd">            The inverted scale of the SDF. The scale of an SDF the half-width of the</span>
<span class="sd">            full SDF volume.</span>
<span class="sd">        width:</span>
<span class="sd">            Number of pixels in x direction. Recommended to use camera instead.</span>
<span class="sd">        height:</span>
<span class="sd">            Number of pixels in y direction. Recommended to use camera instead.</span>
<span class="sd">        fov_deg:</span>
<span class="sd">            The horizontal field of view (i.e., in x direction).</span>
<span class="sd">            Pixels are assumed to be square, i.e., fx=fy, computed based on width</span>
<span class="sd">            and fov_deg.</span>
<span class="sd">            Recommended to use camera instead.</span>
<span class="sd">        threshold:</span>
<span class="sd">            The distance threshold at which sphere tracing should be stopped.</span>
<span class="sd">            Smaller value will be more accurate, but slower and might potentially</span>
<span class="sd">            lead to holes in the rendering for thin structures in the SDF.</span>
<span class="sd">            Larger values will be faster, but will overestimate the thickness.</span>

<span class="sd">            Should always be positive to guarantee convergence.</span>
<span class="sd">        camera:</span>
<span class="sd">            Camera parameters (not supported right now).</span>
<span class="sd">    Returns:</span>
<span class="sd">        The rendered depth image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="kc">None</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">fov_deg</span><span class="p">]</span> <span class="ow">and</span> <span class="n">camera</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either width+height+fov_dev or camera must be provided.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">camera</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;Only width+height+fov_dev currently supported for CPU&quot;</span>
        <span class="p">)</span>
    <span class="c1"># for simplicity use numpy internally</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">save_for_backward</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">inv_scale</span><span class="p">)</span>
    <span class="n">sdf</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="n">position</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="n">orientation</span> <span class="o">=</span> <span class="n">orientation</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="n">inv_scale</span> <span class="o">=</span> <span class="n">inv_scale</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="n">sdf_object</span> <span class="o">=</span> <span class="n">SDFObject</span><span class="p">(</span><span class="n">sdf</span><span class="p">)</span>
    <span class="n">image</span><span class="p">,</span> <span class="n">derivatives</span> <span class="o">=</span> <span class="n">_render_depth</span><span class="p">(</span>
        <span class="n">sdf_object</span><span class="p">,</span>
        <span class="n">width</span><span class="p">,</span>
        <span class="n">height</span><span class="p">,</span>
        <span class="n">fov_deg</span><span class="p">,</span>
        <span class="s2">&quot;d&quot;</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">,</span>
        <span class="n">position</span><span class="p">,</span>
        <span class="n">orientation</span><span class="p">,</span>
        <span class="n">inv_scale</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">derivatives</span> <span class="o">=</span> <span class="n">derivatives</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunctionGPU" class="doc doc-heading">
          <code>SDFRendererFunctionGPU</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.autograd.Function">Function</span></code></p>

  
      <p>Renderer function for signed distance fields.</p>

            <details class="quote">
              <summary>Source code in <code>sdfest/differentiable_renderer/sdf_renderer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SDFRendererFunctionGPU</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">Function</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Renderer function for signed distance fields.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="n">ctx</span><span class="p">,</span>
        <span class="n">sdf</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">orientation</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">inv_scale</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">camera</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Camera</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Render depth image of a 7-DOF discrete signed distance field on the GPU.</span>

<span class="sd">        Also see render_depth_gpu for documentation.</span>

<span class="sd">        Args:</span>
<span class="sd">            ctx:</span>
<span class="sd">                Context object to stash information.</span>
<span class="sd">                See https://pytorch.org/docs/stable/notes/extending.html.</span>
<span class="sd">            sdf:</span>
<span class="sd">                Discrete signed distance field with shape (M, M, M).</span>
<span class="sd">                Arbitrary (but uniform) resolutions are supported.</span>
<span class="sd">            position:</span>
<span class="sd">                The position of the signed distance field origin in the camera frame.</span>
<span class="sd">            orientation:</span>
<span class="sd">                The orientation of the SDF as a normalized quaternion.</span>
<span class="sd">            inv_scale:</span>
<span class="sd">                The inverted scale of the SDF. The scale of an SDF the half-width of the</span>
<span class="sd">                full SDF volume.</span>
<span class="sd">            threshold:</span>
<span class="sd">                The distance threshold at which sphere tracing should be stopped.</span>
<span class="sd">                Smaller value will be more accurate, but slower and might potentially</span>
<span class="sd">                lead to holes in the rendering for thin structures in the SDF.</span>
<span class="sd">                Larger values will be faster, but will overestimate the thickness.</span>

<span class="sd">                Should always be positive to guarantee convergence.</span>
<span class="sd">            camera:</span>
<span class="sd">                Camera parameters.</span>
<span class="sd">        Returns:</span>
<span class="sd">            The rendered depth image.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">get_pinhole_camera_parameters</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="p">(</span><span class="n">image</span><span class="p">,)</span> <span class="o">=</span> <span class="n">sdf_renderer_cpp</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span>
            <span class="n">sdf</span><span class="p">,</span>
            <span class="n">position</span><span class="p">,</span>
            <span class="n">orientation</span><span class="p">,</span>
            <span class="n">inv_scale</span><span class="p">,</span>
            <span class="n">camera</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="n">camera</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
            <span class="n">cx</span><span class="p">,</span>
            <span class="n">cy</span><span class="p">,</span>
            <span class="n">fx</span><span class="p">,</span>
            <span class="n">fy</span><span class="p">,</span>
            <span class="n">threshold</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">save_for_backward</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">sdf</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">inv_scale</span><span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">width</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">height</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">fx</span> <span class="o">=</span> <span class="n">fx</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">fy</span> <span class="o">=</span> <span class="n">fy</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">cx</span> <span class="o">=</span> <span class="n">cx</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">cy</span> <span class="o">=</span> <span class="n">cy</span>
        <span class="k">return</span> <span class="n">image</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">grad_depth_image</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute gradients of inputs with respect to the provided gradients.</span>

<span class="sd">        Normally called by PyTorch as part of a call to backward() on a loss.</span>

<span class="sd">        Args:</span>
<span class="sd">            grad_depth_image:</span>
<span class="sd">        Returns:</span>
<span class="sd">            Gradients of</span>
<span class="sd">                discretized signed distance field, position, orientation, inverted scale</span>
<span class="sd">                followed by None for all the non-supported variables passed to forward.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g_sdf</span> <span class="o">=</span> <span class="n">g_p</span> <span class="o">=</span> <span class="n">g_q</span> <span class="o">=</span> <span class="n">g_is</span> <span class="o">=</span> <span class="n">g_thresh</span> <span class="o">=</span> <span class="n">g_camera</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">g_sdf</span><span class="p">,</span> <span class="n">g_p</span><span class="p">,</span> <span class="n">g_q</span><span class="p">,</span> <span class="n">g_is</span> <span class="o">=</span> <span class="n">sdf_renderer_cpp</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span>
            <span class="n">grad_depth_image</span><span class="p">,</span>
            <span class="o">*</span><span class="n">ctx</span><span class="o">.</span><span class="n">saved_tensors</span><span class="p">,</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">cx</span><span class="p">,</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">cy</span><span class="p">,</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">fx</span><span class="p">,</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">fy</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">g_sdf</span><span class="p">,</span> <span class="n">g_p</span><span class="p">,</span> <span class="n">g_q</span><span class="p">,</span> <span class="n">g_is</span><span class="p">,</span> <span class="n">g_thresh</span><span class="p">,</span> <span class="n">g_camera</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunctionGPU.backward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">backward</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">grad_depth_image</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Compute gradients of inputs with respect to the provided gradients.</p>
<p>Normally called by PyTorch as part of a call to backward() on a loss.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>grad_depth_image</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    Gradients of
        discretized signed distance field, position, orientation, inverted scale
        followed by None for all the non-supported variables passed to forward.</p>

          <details class="quote">
            <summary>Source code in <code>sdfest/differentiable_renderer/sdf_renderer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">grad_depth_image</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute gradients of inputs with respect to the provided gradients.</span>

<span class="sd">    Normally called by PyTorch as part of a call to backward() on a loss.</span>

<span class="sd">    Args:</span>
<span class="sd">        grad_depth_image:</span>
<span class="sd">    Returns:</span>
<span class="sd">        Gradients of</span>
<span class="sd">            discretized signed distance field, position, orientation, inverted scale</span>
<span class="sd">            followed by None for all the non-supported variables passed to forward.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">g_sdf</span> <span class="o">=</span> <span class="n">g_p</span> <span class="o">=</span> <span class="n">g_q</span> <span class="o">=</span> <span class="n">g_is</span> <span class="o">=</span> <span class="n">g_thresh</span> <span class="o">=</span> <span class="n">g_camera</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">g_sdf</span><span class="p">,</span> <span class="n">g_p</span><span class="p">,</span> <span class="n">g_q</span><span class="p">,</span> <span class="n">g_is</span> <span class="o">=</span> <span class="n">sdf_renderer_cpp</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span>
        <span class="n">grad_depth_image</span><span class="p">,</span>
        <span class="o">*</span><span class="n">ctx</span><span class="o">.</span><span class="n">saved_tensors</span><span class="p">,</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">cx</span><span class="p">,</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">cy</span><span class="p">,</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">fx</span><span class="p">,</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">fy</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">g_sdf</span><span class="p">,</span> <span class="n">g_p</span><span class="p">,</span> <span class="n">g_q</span><span class="p">,</span> <span class="n">g_is</span><span class="p">,</span> <span class="n">g_thresh</span><span class="p">,</span> <span class="n">g_camera</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="sdfest.differentiable_renderer.sdf_renderer.SDFRendererFunctionGPU.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">sdf</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">inv_scale</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">camera</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Render depth image of a 7-DOF discrete signed distance field on the GPU.</p>
<p>Also see render_depth_gpu for documentation.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ctx</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Context object to stash information.
See https://pytorch.org/docs/stable/notes/extending.html.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sdf</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Discrete signed distance field with shape (M, M, M).
Arbitrary (but uniform) resolutions are supported.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>position</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The position of the signed distance field origin in the camera frame.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>orientation</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The orientation of the SDF as a normalized quaternion.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inv_scale</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The inverted scale of the SDF. The scale of an SDF the half-width of the
full SDF volume.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The distance threshold at which sphere tracing should be stopped.
Smaller value will be more accurate, but slower and might potentially
lead to holes in the rendering for thin structures in the SDF.
Larger values will be faster, but will overestimate the thickness.</p>
<p>Should always be positive to guarantee convergence.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>camera</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="sdfest.differentiable_renderer.sdf_renderer.Camera" href="#sdfest.differentiable_renderer.sdf_renderer.Camera">Camera</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Camera parameters.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    The rendered depth image.</p>

          <details class="quote">
            <summary>Source code in <code>sdfest/differentiable_renderer/sdf_renderer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">,</span>
    <span class="n">sdf</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">orientation</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">inv_scale</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">camera</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Camera</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Render depth image of a 7-DOF discrete signed distance field on the GPU.</span>

<span class="sd">    Also see render_depth_gpu for documentation.</span>

<span class="sd">    Args:</span>
<span class="sd">        ctx:</span>
<span class="sd">            Context object to stash information.</span>
<span class="sd">            See https://pytorch.org/docs/stable/notes/extending.html.</span>
<span class="sd">        sdf:</span>
<span class="sd">            Discrete signed distance field with shape (M, M, M).</span>
<span class="sd">            Arbitrary (but uniform) resolutions are supported.</span>
<span class="sd">        position:</span>
<span class="sd">            The position of the signed distance field origin in the camera frame.</span>
<span class="sd">        orientation:</span>
<span class="sd">            The orientation of the SDF as a normalized quaternion.</span>
<span class="sd">        inv_scale:</span>
<span class="sd">            The inverted scale of the SDF. The scale of an SDF the half-width of the</span>
<span class="sd">            full SDF volume.</span>
<span class="sd">        threshold:</span>
<span class="sd">            The distance threshold at which sphere tracing should be stopped.</span>
<span class="sd">            Smaller value will be more accurate, but slower and might potentially</span>
<span class="sd">            lead to holes in the rendering for thin structures in the SDF.</span>
<span class="sd">            Larger values will be faster, but will overestimate the thickness.</span>

<span class="sd">            Should always be positive to guarantee convergence.</span>
<span class="sd">        camera:</span>
<span class="sd">            Camera parameters.</span>
<span class="sd">    Returns:</span>
<span class="sd">        The rendered depth image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">get_pinhole_camera_parameters</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="p">(</span><span class="n">image</span><span class="p">,)</span> <span class="o">=</span> <span class="n">sdf_renderer_cpp</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span>
        <span class="n">sdf</span><span class="p">,</span>
        <span class="n">position</span><span class="p">,</span>
        <span class="n">orientation</span><span class="p">,</span>
        <span class="n">inv_scale</span><span class="p">,</span>
        <span class="n">camera</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
        <span class="n">camera</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
        <span class="n">cx</span><span class="p">,</span>
        <span class="n">cy</span><span class="p">,</span>
        <span class="n">fx</span><span class="p">,</span>
        <span class="n">fy</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">save_for_backward</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">sdf</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">inv_scale</span><span class="p">)</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">width</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">height</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">fx</span> <span class="o">=</span> <span class="n">fx</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">fy</span> <span class="o">=</span> <span class="n">fy</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">cx</span> <span class="o">=</span> <span class="n">cx</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">cy</span> <span class="o">=</span> <span class="n">cy</span>
    <span class="k">return</span> <span class="n">image</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>



<div class="doc doc-object doc-function">



<h2 id="sdfest.differentiable_renderer.sdf_renderer.render_depth_gpu" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">render_depth_gpu</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">inv_scale</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fov_deg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">camera</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Render depth image of a 7-DOF discrete signed distance field on the GPU.</p>
<p>The SDF position is assumed to be in the camera frame under OpenGL convention.</p>
<p>That is, camera looks along negative z-axis, y pointing upwards and x to the
right. Note that the rendered image will still follow the classical computer
vision convention, of first row being up in the camera frame.</p>
<p>Camera can be specified either via camera parameter giving most
flexbility or alternatively by providing width, height and fov_deg.</p>
<p>All provided tensors must reside on the GPU.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sdf</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Discrete signed distance field with shape (M, M, M).
Arbitrary (but uniform) resolutions are supported.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>position</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The position of the signed distance field origin in the camera frame.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>orientation</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The orientation of the SDF as a normalized quaternion.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inv_scale</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The inverted scale of the SDF. The scale of an SDF the half-width of the
full SDF volume.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>width</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of pixels in x direction. Recommended to use camera instead.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>height</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of pixels in y direction. Recommended to use camera instead.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>fov_deg</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The horizontal field of view (i.e., in x direction).
Pixels are assumed to be square, i.e., fx=fy, computed based on width
and fov_deg.
Recommended to use camera instead.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The distance threshold at which sphere tracing should be stopped.
Smaller value will be more accurate, but slower and might potentially
lead to holes in the rendering for thin structures in the SDF.
Larger values will be faster, but will overestimate the thickness.</p>
<p>Should always be positive to guarantee convergence.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>camera</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="sdfest.differentiable_renderer.sdf_renderer.Camera" href="#sdfest.differentiable_renderer.sdf_renderer.Camera">Camera</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Camera parameters.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    The rendered depth image.</p>

          <details class="quote">
            <summary>Source code in <code>sdfest/differentiable_renderer/sdf_renderer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">render_depth_gpu</span><span class="p">(</span>
    <span class="n">sdf</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">orientation</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">inv_scale</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">height</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fov_deg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">camera</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Camera</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Render depth image of a 7-DOF discrete signed distance field on the GPU.</span>

<span class="sd">    The SDF position is assumed to be in the camera frame under OpenGL convention.</span>

<span class="sd">    That is, camera looks along negative z-axis, y pointing upwards and x to the</span>
<span class="sd">    right. Note that the rendered image will still follow the classical computer</span>
<span class="sd">    vision convention, of first row being up in the camera frame.</span>

<span class="sd">    Camera can be specified either via camera parameter giving most</span>
<span class="sd">    flexbility or alternatively by providing width, height and fov_deg.</span>

<span class="sd">    All provided tensors must reside on the GPU.</span>

<span class="sd">    Args:</span>
<span class="sd">        sdf:</span>
<span class="sd">            Discrete signed distance field with shape (M, M, M).</span>
<span class="sd">            Arbitrary (but uniform) resolutions are supported.</span>
<span class="sd">        position:</span>
<span class="sd">            The position of the signed distance field origin in the camera frame.</span>
<span class="sd">        orientation:</span>
<span class="sd">            The orientation of the SDF as a normalized quaternion.</span>
<span class="sd">        inv_scale:</span>
<span class="sd">            The inverted scale of the SDF. The scale of an SDF the half-width of the</span>
<span class="sd">            full SDF volume.</span>
<span class="sd">        width:</span>
<span class="sd">            Number of pixels in x direction. Recommended to use camera instead.</span>
<span class="sd">        height:</span>
<span class="sd">            Number of pixels in y direction. Recommended to use camera instead.</span>
<span class="sd">        fov_deg:</span>
<span class="sd">            The horizontal field of view (i.e., in x direction).</span>
<span class="sd">            Pixels are assumed to be square, i.e., fx=fy, computed based on width</span>
<span class="sd">            and fov_deg.</span>
<span class="sd">            Recommended to use camera instead.</span>
<span class="sd">        threshold:</span>
<span class="sd">            The distance threshold at which sphere tracing should be stopped.</span>
<span class="sd">            Smaller value will be more accurate, but slower and might potentially</span>
<span class="sd">            lead to holes in the rendering for thin structures in the SDF.</span>
<span class="sd">            Larger values will be faster, but will overestimate the thickness.</span>

<span class="sd">            Should always be positive to guarantee convergence.</span>
<span class="sd">        camera:</span>
<span class="sd">            Camera parameters.</span>
<span class="sd">    Returns:</span>
<span class="sd">        The rendered depth image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="kc">None</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">fov_deg</span><span class="p">]</span> <span class="ow">and</span> <span class="n">camera</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either width+height+fov_dev or camera must be provided.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">camera</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">fov_deg</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">camera</span> <span class="o">=</span> <span class="n">Camera</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pixel_center</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SDFRendererFunctionGPU</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="n">sdf</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">inv_scale</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">camera</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>